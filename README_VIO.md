# 视觉惯性里程计 (VIO) 实现

这个项目实现了一个简单的视觉惯性里程计(Visual-Inertial Odometry, VIO)系统，用于整合IMU数据、陀螺仪数据和视频流来估计相机的运动轨迹。

## 什么是VIO？

视觉惯性里程计(VIO)是一种结合视觉信息和惯性测量单元(IMU)数据的定位技术，可以在没有GPS的环境中实现精确的位置跟踪。VIO通过融合两种互补的传感器数据源来获得更准确的位置估计：

- **视觉部分**：通过分析连续视频帧中的特征点移动来估计相机的运动
- **惯性部分**：使用IMU(加速度计和陀螺仪)数据来预测相机的短期运动

## 系统工作流程

1. **数据收集**：使用`data_collector.py`收集手机的IMU数据、陀螺仪数据和视频流
2. **数据同步**：将不同频率的传感器数据同步到相同的时间点
3. **VIO处理**：
   - 使用IMU和陀螺仪数据进行运动预测
   - 使用视觉特征跟踪进行位置校正
   - 融合两种估计获得最终的位置和姿态

## 使用方法

### 步骤1：收集数据

首先使用`data_collector.py`收集数据：

```bash
python data_collector.py
```

按照提示完成六种不同的运动模式数据收集。

### 步骤2：运行VIO算法

收集完数据后，运行VIO算法处理数据：

```bash
python simple_vio.py
```

程序会自动选择最新的数据会话，并对每种运动类型进行处理。

## 结果输出

对于每种运动类型，VIO算法会生成以下输出：

1. **轨迹图**：显示估计的3D相机运动轨迹
2. **特征匹配可视化**：展示连续帧之间的特征点匹配
3. **可视化视频**：包含特征匹配和轨迹信息的视频
4. **轨迹数据**：以NumPy格式保存的轨迹坐标数据

所有结果都保存在对应运动类型的`vio_results`子目录中。

## 技术细节

### 视觉部分

- 使用ORB特征检测和描述
- 通过特征匹配计算本质矩阵
- 从本质矩阵恢复相对旋转和平移

### 惯性部分

- 对陀螺仪数据积分获得姿态变化
- 对加速度数据进行双重积分获得位置变化
- 考虑重力影响和传感器偏置

### 融合策略

- 使用简单的加权平均融合视觉和惯性估计
- 对姿态使用SLERP(球面线性插值)进行融合

## 局限性

这是一个简化的VIO实现，存在以下局限性：

1. 没有使用高级滤波技术(如扩展卡尔曼滤波或优化方法)
2. 尺度不确定性问题处理较为简单
3. 没有进行严格的相机-IMU标定
4. 没有处理特征点长期跟踪和回环检测

## 进一步改进

- 实现扩展卡尔曼滤波或滑动窗口优化
- 添加相机-IMU标定流程
- 实现特征点长期跟踪
- 添加回环检测功能
- 改进尺度估计方法
